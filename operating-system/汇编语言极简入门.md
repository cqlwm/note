# 汇编语言极简入门



## 什么是汇编语言

assembly language，缩写为 asm。

计算机执行的是二进制指令，对于用户来说并不友好。汇编语言就是特定二进制指令的文本表示形式。将汇编语言翻译成二进制指令的过程就是汇编的过程。



> 每一种 CPU 的机器指令都是不一样的，因此对应的汇编语言也不一样。目前最常见的是 x86 汇编语言，即 Intel 公司的 CPU 。



## 寄存器

学习汇编语言需要了解两个前置知识：寄存器和内存模型。



CUP本身只负责运算，不负责数据的存储，数据一般存储在内存中。但是CPU的运算速度远高于内存，为了尽可能的利用CPU的性能，所以引入了寄存器。由寄存器负载从内存中读取数据并将最常用的数据暂存，CPU不直接与内存打交道，而是从寄存器中读取数据。



> 一般CPU还会带有多级缓存，寄存器会从多级缓存中读取数据。



### 寄存器的种类

目前存在100多种通用寄存器。

常见的 32位 CPU、64位 CPU ，其实指的就是寄存器的大小。32 位 CPU 的寄存器大小就是4个字节。



## 内存模型

寄存器只能存放很少量的数据，大多数时候，CPU 要指挥寄存器，直接跟内存交换数据。所以，除了寄存器，还必须了解内存怎么储存数据。

### heap

用来保存程序运行过程中的数据。

### stack

用来保存程序中方法执行的过程和临时数据的存储。



## CPU指令



示例代码:

```c
int add_a_and_b(int a, int b) {
  return a + b;
}

int main() {
  int n = add_a_and_b(2, 3);
  return n;
}
```



使用GCC将C语言程序翻译成汇编代码:

```sh
gcc -S example.c
```



```assembly
_add_a_and_b:
   push   %ebx
   mov    %eax, [%esp+8] 
   mov    %ebx, [%esp+12]
   add    %eax, %ebx 
   pop    %ebx 
   ret  

_main:
   push   3
   push   2
   call   _add_a_and_b 
   add    %esp, 8
   ret
```



一次CPU执行分为两部分，一个CPU指令和零到多个运算子(运算参数)。

```assembly
push   %ebx
```
